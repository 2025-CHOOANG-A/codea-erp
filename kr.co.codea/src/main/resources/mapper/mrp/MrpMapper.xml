<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.codea.mrp.MrpMapper">

<!-- 날짜검색 -->
<select id="alldata" resultType="kr.co.codea.mrp.MrpDTO">

</select>

<!-- 생산계획 모든 데이터 가져오는 select -->
<select id="plandata" resultType="kr.co.codea.mrp.MrpDTO">

</select>

<!-- 계산하기 누를시 들어가는 데이터 insert -->
<insert id="insertMrp">

</insert>

<!-- 생산계획 조회 -->
    <select id="ProductPlanList" parameterType="kr.co.codea.productplan.ProductPlanDTO" resultType="kr.co.codea.productplan.ProductPlanDTO">
SELECT
	    PP.PLAN_ID,
	    PP.ITEM_CODE,
	    I.ITEM_NAME,
	    PP.START_DATE,
	    PP.DUE_DATE,
	    PP.COMPLETION_DATE, 
	    PP.PLAN_QTY,
	    PP.ACTUAL_QTY,       
	    PP.STATUS,
	    PP.REMARK,
	    PP.EMP_NO
	FROM
	    PRODUCTION_PLAN PP
	JOIN
	    ITEM I ON PP.ITEM_CODE = I.ITEM_CODE
    <where>
        <if test="keyword != null and keyword != ''">
            AND (
                PP.PLAN_ID LIKE '%' || #{keyword} || '%'
                OR I.ITEM_NAME LIKE '%' || #{keyword} || '%'
            )
        </if>
        <if test="startDate != null">
            AND PP.START_DATE >= #{startDate}
        </if>
        <if test="endDate != null">
            AND PP.DUE_DATE &lt;= #{endDate}
        </if>
        <if test="status != null and status != ''">
            AND PP.STATUS = #{status}
        </if>
        <if test="empNo != null and empNo != ''">
            AND PP.EMP_NO = #{empNo}
        </if>
    </where>
    ORDER BY PP.PLAN_ID DESC
    </select>


</mapper>